<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Modern Fortran edition of conmin">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>conmin &ndash; conmin</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">conmin </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/conmin.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>conmin
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="39.2% of total for procedures.">716 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/conmin.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/conmin.f90.html'>conmin.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/conmin_module.html'>conmin_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">conmin</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/conmin.html#src">conmin</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine conmin(me, x, vlb, vub, g, scal, df, a, s, g1, g2, b, c, isc, ic, ms1, n1, n2, n3, n4, n5)  
</h2>
    

    <p>Routine to solve constrained or unconstrained function minimization.</p>
<p>JUNE, 1979 VERSION</p>
<p>STORAGE REQUIREMENTS:
    PROGRAM - 7000 DECIMAL WORDS (CDC COMPUTER)
    ARRAYS  - APPROX. 2<em>(NDV</em><em>2)+26</em>NDV+4*NCON, WHERE N3 = NDV+2.
RE-SCALE VARIABLES IF REQUIRED.</p>

    <h3>Type Bound</h3>
    <p><a href='../type/conmin_class.html'>conmin_class</a></p>

    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-me~2"></span>
              class(<a href='../type/conmin_class.html'>conmin_class</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~2"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>x</strong>(n1)</td>
            <td>
                <p>Vector of decision variables, <code>X(I), I = 1, NDV</code>.  The initial
X-vector contains the user's best estimate of the set of optimum
design variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vlb"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>vlb</strong>(n1)</td>
            <td>
                <p>Used only if <code>NSIDE/=0</code>.  <code>VLB(I)</code> is the lower allowable value
(lower bound) of variable <code>X(I)</code>.  If one or more variables, <code>X(I)</code>,
do not have lower bounds, the corresponding <code>VLB(I)</code> must be
initialized to a very large negative number (say <code>-1.0E+10</code>).</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vub"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>vub</strong>(n1)</td>
            <td>
                <p>Used only if <code>NSIDE/=0</code>.  <code>VUB(I)</code> is the maximum allowable value
(upper bound) of <code>X(I)</code>.  If one or more variables, <code>X(I)</code>, do not
have upper bounds, the corresponding <code>VUB(I)</code> must be initialized
to a very large positive number (say <code>1.0E+10</code>).</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-g~2"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>g</strong>(n2)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = 0</code>.  Vector containing all constraint
functions, <code>G(J), J = 1, NCON</code> for current decision variables, <code>X</code>.
Calculate <code>G(J), J = 1, NCON</code> if <code>INFO = 2</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scal"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scal</strong>(n1)</td>
            <td>
                <p>Not used if <code>NSCAL = 0</code>.  Vector of scaling parameters.  If
<code>NSCAL&gt;0</code> vector SCAL need not be initialized since SCAL will
be defined in CONMIN and its associated routines.  If <code>NSCAL&lt;0</code>,
vector SCAL is initialized in the main program, and the scaled
variables <code>X(I) = X(I)/SCAL(I)</code>.  Efficiency of the optimization
process can sometimes be improved if the variables are either
normalized or are scaled in such a way that the partial deri-
vative of the objective function, OBJ, with respect to variable
<code>X(I)</code> is of the same order of magnitude for all <code>X(I)</code>.  <code>SCAL(I)</code>
must be greater than zero because a negative value of <code>SCAL(I)</code>
will result in a change of sign of <code>X(I)</code> and possibly yield
erroneous optimization results.  The decision of if, and how, the
variables should be scaled is highly problem dependent, and some
experimentation is desirable for any given class of problems.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-df"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>df</strong>(n1)</td>
            <td>
                <p>Analytic gradient of the objective function for the current
decision variables, <code>X(I)</code>.  <code>DF(I)</code> contains the partial derivative
of <code>OBJ</code> with respect to <code>X(I)</code>.  Calculate <code>DF(I), I = 1,
NDV</code> if <code>INFO = 3</code> or <code>INFO = 4</code> and if <code>NFDG = 0</code> or <code>NFDG = 2</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>a</strong>(n1,n3)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = 0</code>.  Gradients of active or violated
constraints, for current decision variables, <code>X(I)</code>.
<code>A(J,I)</code> contains the gradient of the Jth active or violated
constraint, <code>G(J)</code>, with respect to the Ith decision variable,
<code>X(I)</code> for <code>J = 1, NAC</code> and <code>I = 1, NDV</code>.  Calculate if <code>INFO = 4</code>
and <code>NFDG = 0</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-s"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>s</strong>(n1)</td>
            <td>
                <p>Move direction in the NDV-dimensional optimization space.  <code>S(I)</code>
gives the rate at which variable <code>X(I)</code> changes with respect to
<code>ALPHA</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-g1"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>g1</strong>(n2)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = NSCAL = 0</code>.  Used for temporary
storage of constraint values <code>G(J), J = 1, NCON</code> and decision
variables <code>X(I), I = 1, NDV</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-g2"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>g2</strong>(n2)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = 0</code>.  Used for temporary storage of
constraint values <code>G(J), J = 1, NCON</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-b"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>b</strong>(n3,n3)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = 0</code>.  Used in determining direction
vector S for constrained minimization problems.  Array <code>B</code> may
be used for temporary storage in external routine SUB1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c"></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>c</strong>(n4)</td>
            <td>
                <p>Not used in <code>NCON = NSIDE = 0</code>.  Used with array B in determining
direction vector S for constrained minimization problems.  Used
for temporary storage of vector X if <code>NSCAL/=0</code>. routine SUB1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-isc"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>isc</strong>(n2)</td>
            <td>
                <p>Not used if <code>NCON = 0</code>.  Linear constraint identification vector.
If constraint <code>G(J)</code> is known to be a linear function of the
decision variables, <code>X(I)</code>, <code>ISC(I)</code> should be initialized to
<code>ISC(I) = 1</code>.  If constraint <code>G(J)</code> is nonlinear <code>ISC(I)</code> is initialized
to <code>ISC(I) = 0</code>.  Identification of linear constraints may improve
efficiency of the optimization process and is therefore desirable,
but is not essential.  If <code>G(J)</code> is not specifically known to be
linear, set <code>ISC(I) = 0</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ic"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ic</strong>(n3)</td>
            <td>
                <p>Identifies which constraints are active or violated.  <code>IC(J)</code>
contains the number of the Jth active or violated constraint
for <code>J = 1, NAC</code>.  For example, if <code>G(10)</code> is the first active
or violated constraint (<code>G(J)&lt;CT, J = 1,9</code>), set <code>IC(1) = 10</code>.
Calculate if <code>INFO = 4</code> and <code>NFDG = 0</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ms1"></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ms1</strong>(n5)</td>
            <td>
                <p>Not used if <code>NCON = NSIDE = 0</code>.  Used with array <code>B</code> in determining
direction vector <code>S</code> for constrained minimization problems.  Array
MS1 may be used for temporary storage in external routine SUB1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n1"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n1</strong></td>
            <td>
                <p><code>N1 = NDV + 2</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n2</strong></td>
            <td>
                <p><code>N2 = NCON + 2*NDV</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n3</strong></td>
            <td>
                <p><code>N3 = NACMX1</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n4</strong></td>
            <td>
                <p><code>N4 = MAX (N3,NDV)</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n5</strong></td>
            <td>
                <p><code>N5 = 2*N4</code></p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~conmin~~CallsGraph Pages: 1 -->
<svg id="procconminCallsGraph" width="487pt" height="200pt"
 viewBox="0.00 0.00 487.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~conmin~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>proc~~conmin~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-196 483,-196 483,4 -4,4"/>
<!-- proc~conmin -->
<g id="proc~~conmin~~CallsGraph_node1" class="node">
<title>proc~conmin</title>
<polygon fill="none" stroke="black" points="133,-108 0,-108 0,-84 133,-84 133,-108"/>
<text text-anchor="middle" x="66.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50">conmin_class%conmin</text>
</g>
<!-- proc~cnmn01 -->
<g id="proc~~conmin~~CallsGraph_node2" class="node">
<title>proc~cnmn01</title>
<g id="a_proc~~conmin~~CallsGraph_node2"><a xlink:href="../proc/cnmn01.html" xlink:title="conmin_class%cnmn01">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-192 169,-192 169,-168 306,-168 306,-192"/>
<text text-anchor="middle" x="237.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn01</text>
</a>
</g>
</g>
<!-- proc~conmin&#45;&gt;proc~cnmn01 -->
<g id="proc~~conmin~~CallsGraph_edge1" class="edge">
<title>proc~conmin&#45;&gt;proc~cnmn01</title>
<path fill="none" stroke="#000000" d="M84,-108.08C103.5,-121.91 137.31,-144.52 169,-159 173.31,-160.97 177.85,-162.82 182.46,-164.55"/>
<polygon fill="#000000" stroke="#000000" points="181.37,-167.87 191.96,-167.91 183.7,-161.27 181.37,-167.87"/>
</g>
<!-- proc~cnmn02 -->
<g id="proc~~conmin~~CallsGraph_node3" class="node">
<title>proc~cnmn02</title>
<g id="a_proc~~conmin~~CallsGraph_node3"><a xlink:href="../proc/cnmn02.html" xlink:title="conmin_class%cnmn02">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-150 169,-150 169,-126 306,-126 306,-150"/>
<text text-anchor="middle" x="237.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn02</text>
</a>
</g>
</g>
<!-- proc~conmin&#45;&gt;proc~cnmn02 -->
<g id="proc~~conmin~~CallsGraph_edge2" class="edge">
<title>proc~conmin&#45;&gt;proc~cnmn02</title>
<path fill="none" stroke="#000000" d="M115.93,-108.04C135.38,-112.87 157.96,-118.48 178.29,-123.53"/>
<polygon fill="#000000" stroke="#000000" points="177.52,-126.95 188.06,-125.96 179.2,-120.15 177.52,-126.95"/>
</g>
<!-- proc~cnmn03 -->
<g id="proc~~conmin~~CallsGraph_node4" class="node">
<title>proc~cnmn03</title>
<g id="a_proc~~conmin~~CallsGraph_node4"><a xlink:href="../proc/cnmn03.html" xlink:title="conmin_class%cnmn03">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-66 169,-66 169,-42 306,-42 306,-66"/>
<text text-anchor="middle" x="237.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn03</text>
</a>
</g>
</g>
<!-- proc~conmin&#45;&gt;proc~cnmn03 -->
<g id="proc~~conmin~~CallsGraph_edge3" class="edge">
<title>proc~conmin&#45;&gt;proc~cnmn03</title>
<path fill="none" stroke="#000000" d="M115.93,-83.96C135.38,-79.13 157.96,-73.52 178.29,-68.47"/>
<polygon fill="#000000" stroke="#000000" points="179.2,-71.85 188.06,-66.04 177.52,-65.05 179.2,-71.85"/>
</g>
<!-- proc~cnmn05 -->
<g id="proc~~conmin~~CallsGraph_node5" class="node">
<title>proc~cnmn05</title>
<g id="a_proc~~conmin~~CallsGraph_node5"><a xlink:href="../proc/cnmn05.html" xlink:title="conmin_class%cnmn05">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-108 169,-108 169,-84 306,-84 306,-108"/>
<text text-anchor="middle" x="237.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn05</text>
</a>
</g>
</g>
<!-- proc~conmin&#45;&gt;proc~cnmn05 -->
<g id="proc~~conmin~~CallsGraph_edge4" class="edge">
<title>proc~conmin&#45;&gt;proc~cnmn05</title>
<path fill="none" stroke="#000000" d="M133.32,-96C141.63,-96 150.18,-96 158.65,-96"/>
<polygon fill="#000000" stroke="#000000" points="158.91,-99.5 168.91,-96 158.91,-92.5 158.91,-99.5"/>
</g>
<!-- proc~cnmn06 -->
<g id="proc~~conmin~~CallsGraph_node6" class="node">
<title>proc~cnmn06</title>
<g id="a_proc~~conmin~~CallsGraph_node6"><a xlink:href="../proc/cnmn06.html" xlink:title="conmin_class%cnmn06">
<polygon fill="#d9534f" stroke="#d9534f" points="306,-24 169,-24 169,0 306,0 306,-24"/>
<text text-anchor="middle" x="237.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn06</text>
</a>
</g>
</g>
<!-- proc~conmin&#45;&gt;proc~cnmn06 -->
<g id="proc~~conmin~~CallsGraph_edge5" class="edge">
<title>proc~conmin&#45;&gt;proc~cnmn06</title>
<path fill="none" stroke="#000000" d="M84,-83.92C103.5,-70.09 137.31,-47.48 169,-33 173.31,-31.03 177.85,-29.18 182.46,-27.45"/>
<polygon fill="#000000" stroke="#000000" points="183.7,-30.73 191.96,-24.09 181.37,-24.13 183.7,-30.73"/>
</g>
<!-- proc~cnmn04 -->
<g id="proc~~conmin~~CallsGraph_node7" class="node">
<title>proc~cnmn04</title>
<g id="a_proc~~conmin~~CallsGraph_node7"><a xlink:href="../proc/cnmn04.html" xlink:title="conmin_class%cnmn04">
<polygon fill="#d9534f" stroke="#d9534f" points="479,-66 342,-66 342,-42 479,-42 479,-66"/>
<text text-anchor="middle" x="410.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn04</text>
</a>
</g>
</g>
<!-- proc~cnmn03&#45;&gt;proc~cnmn04 -->
<g id="proc~~conmin~~CallsGraph_edge6" class="edge">
<title>proc~cnmn03&#45;&gt;proc~cnmn04</title>
<path fill="none" stroke="#000000" d="M306.08,-54C314.54,-54 323.24,-54 331.83,-54"/>
<polygon fill="#000000" stroke="#000000" points="331.85,-57.5 341.85,-54 331.85,-50.5 331.85,-57.5"/>
</g>
<!-- proc~cnmn08 -->
<g id="proc~~conmin~~CallsGraph_node9" class="node">
<title>proc~cnmn08</title>
<g id="a_proc~~conmin~~CallsGraph_node9"><a xlink:href="../proc/cnmn08.html" xlink:title="cnmn08">
<polygon fill="#d9534f" stroke="#d9534f" points="438.5,-108 382.5,-108 382.5,-84 438.5,-84 438.5,-108"/>
<text text-anchor="middle" x="410.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cnmn08</text>
</a>
</g>
</g>
<!-- proc~cnmn05&#45;&gt;proc~cnmn08 -->
<g id="proc~~conmin~~CallsGraph_edge7" class="edge">
<title>proc~cnmn05&#45;&gt;proc~cnmn08</title>
<path fill="none" stroke="#000000" d="M306.08,-96C328.61,-96 352.88,-96 372.24,-96"/>
<polygon fill="#000000" stroke="#000000" points="372.45,-99.5 382.45,-96 372.45,-92.5 372.45,-99.5"/>
</g>
<!-- proc~cnmn06&#45;&gt;proc~cnmn04 -->
<g id="proc~~conmin~~CallsGraph_edge8" class="edge">
<title>proc~cnmn06&#45;&gt;proc~cnmn04</title>
<path fill="none" stroke="#000000" d="M287.5,-24.04C307.18,-28.87 330.03,-34.48 350.6,-39.53"/>
<polygon fill="#000000" stroke="#000000" points="349.94,-42.98 360.49,-41.96 351.61,-36.18 349.94,-42.98"/>
</g>
<!-- proc~cnmn07 -->
<g id="proc~~conmin~~CallsGraph_node8" class="node">
<title>proc~cnmn07</title>
<g id="a_proc~~conmin~~CallsGraph_node8"><a xlink:href="../proc/cnmn07.html" xlink:title="conmin_class%cnmn07">
<polygon fill="#d9534f" stroke="#d9534f" points="479,-24 342,-24 342,0 479,0 479,-24"/>
<text text-anchor="middle" x="410.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">conmin_class%cnmn07</text>
</a>
</g>
</g>
<!-- proc~cnmn06&#45;&gt;proc~cnmn07 -->
<g id="proc~~conmin~~CallsGraph_edge9" class="edge">
<title>proc~cnmn06&#45;&gt;proc~cnmn07</title>
<path fill="none" stroke="#000000" d="M306.08,-12C314.54,-12 323.24,-12 331.83,-12"/>
<polygon fill="#000000" stroke="#000000" points="331.85,-15.5 341.85,-12 331.85,-8.5 331.85,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">conmin</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vlb</span><span class="p">,</span><span class="w"> </span><span class="n">vub</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">scal</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">isc</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="p">,</span><span class="w"> </span><span class="n">ms1</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">,</span><span class="w"> </span><span class="n">n4</span><span class="p">,</span><span class="w"> </span><span class="n">n5</span><span class="p">)</span>

<span class="w">        </span><span class="c">!!  Routine to solve constrained or unconstrained function minimization.</span>
<span class="w">        </span><span class="c">!!</span>
<span class="w">        </span><span class="c">!!  JUNE, 1979 VERSION</span>
<span class="w">        </span><span class="c">!!</span>
<span class="w">        </span><span class="c">!!  STORAGE REQUIREMENTS:</span>
<span class="w">        </span><span class="c">!!      PROGRAM - 7000 DECIMAL WORDS (CDC COMPUTER)</span>
<span class="w">        </span><span class="c">!!      ARRAYS  - APPROX. 2*(NDV**2)+26*NDV+4*NCON, WHERE N3 = NDV+2.</span>
<span class="w">        </span><span class="c">!!  RE-SCALE VARIABLES IF REQUIRED.</span>

<span class="w">        </span><span class="k">class</span><span class="p">(</span><span class="n">conmin_class</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="c">!! `N1 = NDV + 2`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n2</span><span class="w"> </span><span class="c">!! `N2 = NCON + 2*NDV`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n3</span><span class="w"> </span><span class="c">!! `N3 = NACMX1`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n4</span><span class="w"> </span><span class="c">!! `N4 = MAX (N3,NDV)`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n5</span><span class="w"> </span><span class="c">!! `N5 = 2*N4`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Vector of decision variables, `X(I), I = 1, NDV`.  The initial</span>
<span class="w">                                           </span><span class="c">!! X-vector contains the user&#39;s best estimate of the set of optimum</span>
<span class="w">                                           </span><span class="c">!! design variables.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Used only if `NSIDE/=0`.  `VLB(I)` is the lower allowable value</span>
<span class="w">                                             </span><span class="c">!! (lower bound) of variable `X(I)`.  If one or more variables, `X(I)`,</span>
<span class="w">                                             </span><span class="c">!! do not have lower bounds, the corresponding `VLB(I)` must be</span>
<span class="w">                                             </span><span class="c">!! initialized to a very large negative number (say `-1.0E+10`).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Used only if `NSIDE/=0`.  `VUB(I)` is the maximum allowable value</span>
<span class="w">                                             </span><span class="c">!! (upper bound) of `X(I)`.  If one or more variables, `X(I)`, do not</span>
<span class="w">                                             </span><span class="c">!! have upper bounds, the corresponding `VUB(I)` must be initialized</span>
<span class="w">                                             </span><span class="c">!! to a very large positive number (say `1.0E+10`).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = 0`.  Vector containing all constraint</span>
<span class="w">                                           </span><span class="c">!! functions, `G(J), J = 1, NCON` for current decision variables, `X`.</span>
<span class="w">                                           </span><span class="c">!! Calculate `G(J), J = 1, NCON` if `INFO = 2`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NSCAL = 0`.  Vector of scaling parameters.  If</span>
<span class="w">                                              </span><span class="c">!! `NSCAL&gt;0` vector SCAL need not be initialized since SCAL will</span>
<span class="w">                                              </span><span class="c">!! be defined in CONMIN and its associated routines.  If `NSCAL&lt;0`,</span>
<span class="w">                                              </span><span class="c">!! vector SCAL is initialized in the main program, and the scaled</span>
<span class="w">                                              </span><span class="c">!! variables `X(I) = X(I)/SCAL(I)`.  Efficiency of the optimization</span>
<span class="w">                                              </span><span class="c">!! process can sometimes be improved if the variables are either</span>
<span class="w">                                              </span><span class="c">!! normalized or are scaled in such a way that the partial deri-</span>
<span class="w">                                              </span><span class="c">!! vative of the objective function, OBJ, with respect to variable</span>
<span class="w">                                              </span><span class="c">!! `X(I)` is of the same order of magnitude for all `X(I)`.  `SCAL(I)`</span>
<span class="w">                                              </span><span class="c">!! must be greater than zero because a negative value of `SCAL(I)`</span>
<span class="w">                                              </span><span class="c">!! will result in a change of sign of `X(I)` and possibly yield</span>
<span class="w">                                              </span><span class="c">!! erroneous optimization results.  The decision of if, and how, the</span>
<span class="w">                                              </span><span class="c">!! variables should be scaled is highly problem dependent, and some</span>
<span class="w">                                              </span><span class="c">!! experimentation is desirable for any given class of problems.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Analytic gradient of the objective function for the current</span>
<span class="w">                                            </span><span class="c">!! decision variables, `X(I)`.  `DF(I)` contains the partial derivative</span>
<span class="w">                                            </span><span class="c">!! of `OBJ` with respect to `X(I)`.  Calculate `DF(I), I = 1,</span>
<span class="w">                                            </span><span class="c">!! NDV` if `INFO = 3` or `INFO = 4` and if `NFDG = 0` or `NFDG = 2`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = 0`.  Gradients of active or violated</span>
<span class="w">                                               </span><span class="c">!! constraints, for current decision variables, `X(I)`.</span>
<span class="w">                                               </span><span class="c">!! `A(J,I)` contains the gradient of the Jth active or violated</span>
<span class="w">                                               </span><span class="c">!! constraint, `G(J)`, with respect to the Ith decision variable,</span>
<span class="w">                                               </span><span class="c">!! `X(I)` for `J = 1, NAC` and `I = 1, NDV`.  Calculate if `INFO = 4`</span>
<span class="w">                                               </span><span class="c">!! and `NFDG = 0`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="w"> </span><span class="c">!! Move direction in the NDV-dimensional optimization space.  `S(I)`</span>
<span class="w">                                           </span><span class="c">!! gives the rate at which variable `X(I)` changes with respect to</span>
<span class="w">                                           </span><span class="c">!! `ALPHA`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">g1</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = NSCAL = 0`.  Used for temporary</span>
<span class="w">                                            </span><span class="c">!! storage of constraint values `G(J), J = 1, NCON` and decision</span>
<span class="w">                                            </span><span class="c">!! variables `X(I), I = 1, NDV`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">g2</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = 0`.  Used for temporary storage of</span>
<span class="w">                                            </span><span class="c">!! constraint values `G(J), J = 1, NCON`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">n3</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = 0`.  Used in determining direction</span>
<span class="w">                                               </span><span class="c">!! vector S for constrained minimization problems.  Array `B` may</span>
<span class="w">                                               </span><span class="c">!! be used for temporary storage in external routine SUB1.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">n4</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used in `NCON = NSIDE = 0`.  Used with array B in determining</span>
<span class="w">                                           </span><span class="c">!! direction vector S for constrained minimization problems.  Used</span>
<span class="w">                                           </span><span class="c">!! for temporary storage of vector X if `NSCAL/=0`. routine SUB1.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">isc</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = 0`.  Linear constraint identification vector.</span>
<span class="w">                                             </span><span class="c">!! If constraint `G(J)` is known to be a linear function of the</span>
<span class="w">                                             </span><span class="c">!! decision variables, `X(I)`, `ISC(I)` should be initialized to</span>
<span class="w">                                             </span><span class="c">!! `ISC(I) = 1`.  If constraint `G(J)` is nonlinear `ISC(I)` is initialized</span>
<span class="w">                                             </span><span class="c">!! to `ISC(I) = 0`.  Identification of linear constraints may improve</span>
<span class="w">                                             </span><span class="c">!! efficiency of the optimization process and is therefore desirable,</span>
<span class="w">                                             </span><span class="c">!! but is not essential.  If `G(J)` is not specifically known to be</span>
<span class="w">                                             </span><span class="c">!! linear, set `ISC(I) = 0`.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="c">!! Identifies which constraints are active or violated.  `IC(J)`</span>
<span class="w">                                            </span><span class="c">!! contains the number of the Jth active or violated constraint</span>
<span class="w">                                            </span><span class="c">!! for `J = 1, NAC`.  For example, if `G(10)` is the first active</span>
<span class="w">                                            </span><span class="c">!! or violated constraint (`G(J)&lt;CT, J = 1,9`), set `IC(1) = 10`.</span>
<span class="w">                                            </span><span class="c">!! Calculate if `INFO = 4` and `NFDG = 0`.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">ms1</span><span class="p">(</span><span class="n">n5</span><span class="p">)</span><span class="w"> </span><span class="c">!! Not used if `NCON = NSIDE = 0`.  Used with array `B` in determining</span>
<span class="w">                                             </span><span class="c">!! direction vector `S` for constrained minimization problems.  Array</span>
<span class="w">                                             </span><span class="c">!! MS1 may be used for temporary storage in external routine SUB1.</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alp1</span><span class="p">,</span><span class="w"> </span><span class="n">alp11</span><span class="p">,</span><span class="w"> </span><span class="n">alp12</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">ct1</span><span class="p">,</span><span class="w"> </span><span class="n">ctc</span><span class="p">,</span><span class="w"> </span><span class="n">ff1</span><span class="p">,</span><span class="w"> </span><span class="n">gi</span><span class="p">,</span><span class="w"> </span><span class="n">objb</span><span class="p">,</span><span class="w"> </span><span class="n">objd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">scj</span><span class="p">,</span><span class="w"> </span><span class="n">si</span><span class="p">,</span><span class="w"> </span><span class="n">sib</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x12</span><span class="p">,</span><span class="w"> </span><span class="n">xid</span><span class="p">,</span><span class="w"> </span><span class="n">xx</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">,</span><span class="w"> </span><span class="n">m3</span><span class="p">,</span><span class="w"> </span><span class="n">mcn1</span><span class="p">,</span><span class="w"> </span><span class="n">nci</span><span class="p">,</span><span class="w"> </span><span class="n">ndv1</span><span class="p">,</span><span class="w"> </span><span class="n">ndv2</span><span class="p">,</span><span class="w"> </span><span class="n">nfeasct</span><span class="p">,</span><span class="w"> </span><span class="n">nic</span><span class="p">,</span><span class="w"> </span><span class="n">nnac</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! CONSTANTS.</span>
<span class="w">        </span><span class="n">ndv1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">ndv2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                 CHECK FOR UNBOUNDED SOLUTION</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">! STOP IF OBJ IS LESS THAN -1.0D+40</span>
<span class="w">            </span><span class="c">!if (me%obj &lt;= -1.0e+40_wp) then ! original code</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">-</span><span class="nb">huge</span><span class="p">(</span><span class="mf">1.0_real32</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! JW : replaced with this. note this is single precision huge (~3.0e38)</span>
<span class="w">                                                  </span><span class="c">! This is so it will not overflow if using single precision real numbers.</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5100</span><span class="p">)</span>
<span class="w">                </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">520</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            select case</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="p">)</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">60</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">210</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">410</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">430</span>
<span class="w">            </span><span class="k">end select</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                  SAVE INPUT CONTROL PARAMETERS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7500</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">linobj</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)))</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! TOTALLY UNCONSTRAINED FUNCTION WITH LINEAR OBJECTIVE.</span>
<span class="w">            </span><span class="c">! SOLUTION IS UNBOUNDED.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">linobj</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nside</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                            DEFAULTS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">itmax</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span>
<span class="w">        </span><span class="n">ndv1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">icndir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">icndir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ndv1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">delfun</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">delfun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0001_wp</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.1_wp</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.004_wp</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.01_wp</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">theta</span><span class="w">  </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">theta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">fdch</span><span class="w">   </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">fdch</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">fdchm</span><span class="w">  </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">fdchm</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01_wp</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                 INITIALIZE INTERNAL PARAMETERS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">infog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">ndv2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">mscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span>
<span class="w">        </span><span class="n">ct1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span>
<span class="w">        </span><span class="n">ct1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="o">/</span><span class="n">ct1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">dct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">))</span><span class="o">**</span><span class="n">ct1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">dctl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="p">))</span><span class="o">**</span><span class="n">ct1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0_wp</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">abobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="p">)</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="p">)</span>
<span class="w">        </span><span class="c">! CALCULATE NUMBER OF LINEAR CONSTRAINTS, NLNC.</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!      CHECK TO BE SURE THAT SIDE CONSTRAINTS ARE SATISFIED</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5_wp</span><span class="o">*</span><span class="p">(</span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span>
<span class="w">                    </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span>
<span class="w">                    </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xx</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6500</span><span class="p">)</span><span class="w"> </span><span class="n">i</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! LOWER BOUND VIOLATED.</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6600</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    </span><span class="n">xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6700</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span>
<span class="w">                        </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                    INITIALIZE SCALING VECTOR, SCAL</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">scal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                    </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">si</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">small</span><span class="p">)</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-5_wp</span>
<span class="w">                    </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span>
<span class="w">                    </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="o">/</span><span class="n">si</span>
<span class="w">                    </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">si</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">si</span>
<span class="w">                        </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">si</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="k">            end if</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! ***** CALCULATE INITIAL FUNCTION AND CONSTRAINT VALUES  *****</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">580</span>

<span class="mi">60</span><span class="w">      </span><span class="n">me</span><span class="p">%</span><span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001_wp</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-10_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                PRINT INITIAL DESIGN INFORMATION</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8200</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7600</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7700</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itmax</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">icndir</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                       </span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">linobj</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">,</span><span class="w"> </span><span class="n">n4</span><span class="p">,</span><span class="w"> </span><span class="n">n5</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7900</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">delfun</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7800</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">fdch</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">fdchm</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8000</span><span class="p">)</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                        </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8100</span><span class="p">)</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                        </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                end if</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8300</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9900</span><span class="p">)</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5500</span><span class="p">)</span>
<span class="w">                        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span>
<span class="w">                            </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span>
<span class="w">                            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5600</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                    else</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5700</span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5800</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end if</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9700</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9800</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">g1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">),</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">))</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="k">        end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8900</span><span class="p">)</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! ********************  BEGIN MINIMIZATION  ************************</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="mi">130</span><span class="w">     </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.0001_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0001_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.2_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.2_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.001_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.001_wp</span>

<span class="w">        </span><span class="c">! THE FOLLOWING TWO LINES OF CODE WERE COMMENTED OUT ON 3/5/81</span>

<span class="c">!       NFEAS=NFEAS+1</span>
<span class="c">!       IF (NFEAS&gt;10) GO TO 810</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8400</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8500</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">cta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">! NO MOVE ON LAST ITERATION.  DELETE CONSTRAINTS THAT ARE NO LONGER ACTIVE.</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="n">nnac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nnac</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">250</span>
<span class="w">            </span><span class="n">nnac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nnac</span>
<span class="mi">150</span><span class="w">             </span><span class="n">nic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">ct1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">nic</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ct1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">nic</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">ct1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">250</span>
<span class="w">                    </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                        </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ndv2</span>
<span class="w">                            </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ii</span><span class="p">)</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                        </span><span class="n">ic</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">150</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">            go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">250</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">mscal</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">icndir</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">me</span><span class="p">%</span><span class="n">mscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">                </span><span class="c">!                      SCALE VARIABLES</span>
<span class="w">                </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                    </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">sib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">si</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">si</span>
<span class="w">                        </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="o">/</span><span class="n">si</span>
<span class="w">                        </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="o">*</span><span class="n">si</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sib</span><span class="o">*</span><span class="n">si</span><span class="o">*</span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                            </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sib</span><span class="o">*</span><span class="n">si</span><span class="o">*</span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                    end if</span>
<span class="k">                end do</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8600</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9900</span><span class="p">)</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">        end if</span>
<span class="k">        </span><span class="n">me</span><span class="p">%</span><span class="n">mscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">mscal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!      OBTAIN GRADIENTS OF OBJECTIVE AND ACTIVE CONSTRAINTS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">            </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">580</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="mi">200</span><span class="w">     </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">cnmn01</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">isc</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">vub</span><span class="p">,</span><span class="w"> </span><span class="n">scal</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dx</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dx1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">me</span><span class="p">%</span><span class="n">fi</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iii</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">580</span>

<span class="mi">210</span><span class="w">     </span><span class="n">me</span><span class="p">%</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">520</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                          SCALE GRADIENTS</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">! SCALE GRADIENT OF OBJECTIVE FUNCTION.</span>
<span class="w">            </span><span class="n">df</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span><span class="o">*</span><span class="n">scal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! SCALE GRADIENTS OF ACTIVE CONSTRAINTS.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                    </span><span class="n">scj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="o">*</span><span class="n">scj</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="k">        end if</span>

<span class="mi">250</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                               PRINT</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">! PRINT ACTIVE AND VIOLATED CONSTRAINT NUMBERS.</span>
<span class="w">            </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n3</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">                        </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span>
<span class="w">                        </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">c1</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                            </span><span class="c">! ACTIVE CONSTRAINT.</span>
<span class="w">                            </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                            </span><span class="n">ms1</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                        </span><span class="k">else</span>
<span class="k">                            </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                            </span><span class="c">! VIOLATED CONSTRAINT.</span>
<span class="w">                            </span><span class="n">ms1</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                    end if</span>
<span class="k">                end do</span>
<span class="k">            end if</span>
<span class="k">            </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n3</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5900</span><span class="p">)</span><span class="w"> </span><span class="n">m1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6000</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="n">ms1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6100</span><span class="p">)</span><span class="w"> </span><span class="n">m3</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m3</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6000</span><span class="p">)</span>
<span class="w">                </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="n">ms1</span><span class="p">(</span><span class="n">m3</span><span class="p">:</span><span class="n">m2</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!        CALCULATE GRADIENTS OF ACTIVE SIDE CONSTRAINTS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">mcn1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span>
<span class="w">            </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="c">! LOWER BOUND.</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">xid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x12</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="p">)</span><span class="o">/</span><span class="n">x12</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0e-6_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">ms1</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">i</span>
<span class="w">                    </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">520</span>
<span class="w">                    </span><span class="n">mcn1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcn1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                        </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_wp</span>
<span class="w">                    </span><span class="n">ic</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcn1</span>
<span class="w">                    </span><span class="n">g</span><span class="p">(</span><span class="n">mcn1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gi</span>
<span class="w">                    </span><span class="n">isc</span><span class="p">(</span><span class="n">mcn1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">end if</span>
<span class="w">                </span><span class="c">! UPPER BOUND.</span>
<span class="w">                </span><span class="n">xid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x12</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xid</span><span class="p">)</span><span class="o">/</span><span class="n">x12</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0e-6_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">ms1</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">520</span>
<span class="w">                    </span><span class="n">mcn1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcn1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                        </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                    </span><span class="n">ic</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mcn1</span>
<span class="w">                    </span><span class="n">g</span><span class="p">(</span><span class="n">mcn1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gi</span>
<span class="w">                    </span><span class="n">isc</span><span class="p">(</span><span class="n">mcn1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                              PRINT</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">! PRINT ACTIVE SIDE CONSTRAINT NUMBERS.</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6200</span><span class="p">)</span><span class="w"> </span><span class="n">m1</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m1</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6300</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ms1</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! PRINT GRADIENTS OF ACTIVE AND VIOLATED CONSTRAINTS.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8700</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8800</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span>
<span class="w">                    </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">ms1</span><span class="p">(</span><span class="n">m2</span><span class="p">))</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5200</span><span class="p">)</span><span class="w"> </span><span class="n">m1</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5300</span><span class="p">)</span><span class="w"> </span><span class="n">m3</span>
<span class="w">                    </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                        </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                        </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">8900</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! ******************  DETERMINE SEARCH DIRECTION *******************</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">large</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">340</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                    UNCONSTRAINED FUNCTION</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! FIND DIRECTION OF STEEPEST DESCENT OR CONJUGATE DIRECTION.</span>
<span class="c">!</span>
<span class="c">!  S. N. 575 ADDED ON 2/25/81</span>
<span class="c">!</span>
<span class="mi">330</span><span class="w">     </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="c">! IF KCOUNT&gt;ICNDIR  RESTART CONJUGATE DIRECTION ALGORITHM.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">icndir</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! IF JDIR = 0 FIND DIRECTION OF STEEPEST DESCENT.</span>
<span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">cnmn02</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dftdf1</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">)</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">380</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                      CONSTRAINED FUNCTION</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! FIND USABLE-FEASIBLE DIRECTION.</span>
<span class="mi">340</span><span class="w">     </span><span class="n">me</span><span class="p">%</span><span class="n">kcount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">phi</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="mf">0.0_wp</span>

<span class="w">        </span><span class="c">! THE FOLLOWING LINE OF CODE WAS COMMENTED OUT ON 3/5/81</span>
<span class="c">!</span>
<span class="c">!       IF (NFEAS==1) PHI=5.</span>
<span class="c">!       CALCULATE DIRECTION, S.</span>
<span class="w">        </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">cnmn05</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">isc</span><span class="p">,</span><span class="w"> </span><span class="n">ic</span><span class="p">,</span><span class="w"> </span><span class="n">ms1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="p">,</span><span class="w"> </span><span class="n">n3</span><span class="p">,</span><span class="w"> </span><span class="n">n4</span><span class="p">,</span><span class="w"> </span><span class="n">n5</span><span class="p">)</span>

<span class="w">        </span><span class="c">! THE FOLLOWING LINE WAS ADDED ON 2/25/81</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">330</span>

<span class="w">        </span><span class="c">! THE FOLLOWING FIVE LINES WERE COMMENTED OUT ON 3/5/81</span>
<span class="w">        </span><span class="c">! REASON : THEY WERE NOT IN G. VANDERPLAATS LISTING</span>
<span class="c">!</span>
<span class="c">!       IF THIS DESIGN IS FEASIBLE AND LAST ITERATION WAS INFEASIBLE,</span>
<span class="c">!       SET ABOBJ1=.05 (5 PERCENT).</span>
<span class="c">!       IF (NVC==0 .AND. NFEAS&gt;1) ABOBJ1=.05</span>
<span class="c">!       IF (NVC==0) NFEAS=0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9000</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">ndv1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7400</span><span class="p">)</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">ndv1</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! ****************** ONE-DIMENSIONAL SEARCH ************************</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">ndv1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0e-6_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">450</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!             FIND ALPHA TO OBTAIN A FEASIBLE DESIGN</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0_wp</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                </span><span class="n">nci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">nci</span><span class="p">)</span>
<span class="w">                </span><span class="n">ctc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">nci</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ctc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ctc</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dot_product</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">),</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span>
<span class="w">                    </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp1</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">ndv2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">alp1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">small</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="o">/</span><span class="n">alp1</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp1</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end if</span>
<span class="k">            end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                   LIMIT CHANCE TO ABOBJ1*OBJ</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="mi">380</span><span class="w">     </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">large</span>
<span class="w">        </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">si</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.01_wp</span><span class="p">)</span><span class="w"> </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">small</span><span class="p">)</span><span class="w"> </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="o">*</span><span class="n">si</span><span class="o">/</span><span class="n">me</span><span class="p">%</span><span class="n">slope</span>
<span class="w">        </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">alp1</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">alp1</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp1</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!               LIMIT CHANGE IN VARIABLE TO ALPHAX</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">large</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">            </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">si</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.1_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="o">/</span><span class="n">si</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">alp11</span><span class="p">)</span><span class="w"> </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp1</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end do</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">alp11</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp11</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp11</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">large</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">large</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">small</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">small</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9100</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6400</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">420</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!       DO ONE-DIMENSIONAL SEARCH FOR UNCONSTRAINED FUNCTION</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">410</span><span class="w">     </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">cnmn03</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">fff</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">me</span><span class="p">%</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">f2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">f3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">f4</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">app</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kount</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="p">)</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">580</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="c">! PROCEED TO CONVERGENCE CHECK.</span>
<span class="w">        </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">450</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!   SOLVE ONE-DIMENSIONAL SEARCH PROBLEM FOR CONSTRAINED FUNCTION</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="mi">420</span><span class="w">     </span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="mi">430</span><span class="w">     </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">cnmn06</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">vlb</span><span class="p">,</span><span class="w"> </span><span class="n">vub</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">scal</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">,</span><span class="w"> </span><span class="n">g2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">slope</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">a4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">me</span><span class="p">%</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">f2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">f3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cv1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cv2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cv3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cv4</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpca</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpfes</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpln</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpmin</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpnc</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">me</span><span class="p">%</span><span class="n">alpsav</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alpsid</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alptot</span><span class="p">,</span><span class="w"> </span><span class="n">isc</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">icount</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">igood1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                       </span><span class="n">me</span><span class="p">%</span><span class="n">igood2</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">igood3</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">igood4</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ibest</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iii</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nlnc</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="p">)</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">jgoto</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">580</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">jdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! *******************     UPDATE ALPHAX   **************************</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="mi">450</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0e+19_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">        </span><span class="c">! UPDATE ALPHAX TO BE AVERAGE OF MAXIMUM CHANGE IN X(I) AND ALHPAX.</span>
<span class="w">        </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">            </span><span class="n">si</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">alp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span><span class="o">*</span><span class="n">si</span><span class="o">/</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">alp11</span><span class="p">)</span><span class="w"> </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp1</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end do</span>
<span class="k">        </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5_wp</span><span class="o">*</span><span class="p">(</span><span class="n">alp11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="p">)</span>
<span class="w">        </span><span class="n">alp12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0_wp</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">alp11</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">alp12</span><span class="p">)</span><span class="w"> </span><span class="n">alp11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp12</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">alphax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp11</span>
<span class="w">        </span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="c">! ABSOLUTE CHANGE IN OBJECTIVE.</span>
<span class="w">        </span><span class="n">objd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">        </span><span class="n">objb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">objd</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">objb</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="p">)</span><span class="w"> </span><span class="n">objb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">objb</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                              PRINT</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! PRINT MOVE PARAMETER, NEW X-VECTOR AND CONSTRAINTS.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9200</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">alp</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">objb</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9300</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9400</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9500</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9600</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9800</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="n">ff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">ff1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">g1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff1</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">g1</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">g1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">),</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">))</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end if</span>
<span class="k">        end if</span>

<span class="w">        </span><span class="c">!  THE FOLLOWING CODE WAS ADDED ON 3/5/81</span>
<span class="w">        </span><span class="c">!</span>
<span class="w">        </span><span class="c">!  IT HAD NOT BEEN REPORTED AS A FIX TO MAOB</span>
<span class="w">        </span><span class="c">!  BUT WAS SENT TO JEFF STROUD A YEAR AGO</span>
<span class="w">        </span><span class="c">!  SEE OTHER COMMENTS IN CONMIN SUBROUTINE FOR DELETIONS OF CODE</span>
<span class="w">        </span><span class="c">!  ON 3/5/81 PERTAINING TO THIS FIX</span>

<span class="w">        </span><span class="c">! CHECK FEASIBILITY</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">nfeasct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">            </span><span class="c">! added by slp 11/17/94</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span>
<span class="w">                </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">c1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">510</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05_wp</span>
<span class="c">!cc</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0_wp</span>
<span class="mi">510</span><span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">nfeasct</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">520</span>
<span class="w">        </span><span class="k">end if</span>

<span class="w">        </span><span class="c">! END OF INSERTED FIX</span>

<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                      CHECK CONVERGENCE</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! STOP IF ITER EQUALS ITMAX.</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itmax</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                 ABSOLUTE CHANGE IN OBJECTIVE</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="n">objb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">objd</span><span class="p">)</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">objb</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dabfun</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="c">!                 RELATIVE CHANGE IN OBJECTIVE</span>
<span class="w">            </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">obj1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0e-10_wp</span><span class="p">)</span><span class="w"> </span><span class="n">objd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">objd</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">obj1</span><span class="p">)</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">abobj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">abobj</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">objd</span><span class="p">))</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">abobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">objd</span><span class="p">)</span>
<span class="w">            </span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">objd</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">delfun</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">me</span><span class="p">%</span><span class="n">obj1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">                </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">                </span><span class="c">!       REDUCE CT IF OBJECTIVE FUNCTION IS CHANGING SLOWLY</span>
<span class="w">                </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">130</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">dct</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="o">*</span><span class="n">me</span><span class="p">%</span><span class="n">dctl</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">me</span><span class="p">%</span><span class="n">ctmin</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">me</span><span class="p">%</span><span class="n">ctlmin</span>
<span class="w">                </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">130</span>
<span class="w">            </span><span class="k">end if</span>
<span class="k">        end if</span>

<span class="mi">520</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">n3</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10200</span><span class="p">)</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">! ****************  FINAL FUNCTION INFORMATION  ********************</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! UN-SCALE THE DESIGN VARIABLES.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="o">*</span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="o">*</span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end if</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                       PRINT FINAL RESULTS</span>
<span class="w">        </span><span class="c">! ------------------------------------------------------------------</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iprint</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10300</span><span class="p">)</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9500</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">9800</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">report</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span><span class="p">),</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">))</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span>
<span class="w">                    </span><span class="n">m1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5400</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="w">                </span><span class="c">! DETERMINE WHICH CONSTRAINTS ARE ACTIVE AND PRINT.</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span>
<span class="w">                    </span><span class="n">me</span><span class="p">%</span><span class="n">cta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctam</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctbm</span>
<span class="w">                    </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">cta</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ct</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ctl</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">isc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                        </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="n">ic</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="n">ms1</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">5900</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6000</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="n">ic</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6100</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6000</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="n">ms1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">me</span><span class="p">%</span><span class="n">nvc</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nside</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! DETERMINE WHICH SIDE CONSTRAINTS ARE ACTIVE AND PRINT.</span>
<span class="w">                </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">                    </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">xid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vlb</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x12</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                    </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xid</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="p">)</span><span class="o">/</span><span class="n">x12</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0e-6_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="n">ms1</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">i</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">xid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vub</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                    </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">xid</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x12</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span><span class="w"> </span><span class="n">x12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">                    </span><span class="n">gi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">xi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xid</span><span class="p">)</span><span class="o">/</span><span class="n">x12</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gi</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0e-6_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="n">ms1</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span>
<span class="k">                write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6200</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6300</span><span class="p">)</span>
<span class="w">                    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10100</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ms1</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nac</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>
<span class="k">            write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6800</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iter</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itmax</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">6900</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfeas</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">nfeasct</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7000</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iobj</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7100</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">kobj</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7200</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">itrm</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">7300</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">iter</span>
<span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10400</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10500</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10600</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">ncon</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">nfdg</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">iunit</span><span class="p">,</span><span class="w"> </span><span class="mi">10700</span><span class="p">)</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ncal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="mi">580</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">nscal</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">igoto</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="w">        </span><span class="c">! UN-SCALE VARIABLES.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">me</span><span class="p">%</span><span class="n">ndv</span>
<span class="w">            </span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">scal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        return</span>

<span class="w">        </span><span class="c">!  ------------------------------------------------------------------</span>
<span class="w">        </span><span class="c">!                             FORMATS</span>
<span class="w">        </span><span class="c">!  ------------------------------------------------------------------</span>

<span class="mi">5000</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;A COMPLETELY UNCONSTRAINED FUNCTION WITH A LINEAR OBJECTIVE IS SPECIFIED&#39;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LINOBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="o">/</span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NCON   =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NSIDE  =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONTROL RETURNED TO CALLING PROGRAM&#39;</span><span class="p">)</span>
<span class="mi">5100</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;CONMIN HAS ACHIEVED A SOLUTION OF OBJ LESS THAN -1.0E+40&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SOLUTION APPEARS TO BE UNBOUNDED&#39;</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OPTIMIZATION IS TERMINATED&#39;</span><span class="p">)</span>
<span class="mi">5200</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINT NUMBER&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">5300</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SIDE CONSTRAINT ON VARIABLE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">5400</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;)  &#39;</span><span class="p">,</span><span class="w"> </span><span class="mf">6e13</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">5500</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LINEAR CONSTRAINT IDENTIFIERS (ISC)&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NON-ZERO INDICATES LINEAR CONSTRAINT&#39;</span><span class="p">)</span>
<span class="mi">5600</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;)  &#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="n">i5</span><span class="p">)</span>
<span class="mi">5700</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ALL CONSTRAINTS ARE LINEAR&#39;</span><span class="p">)</span>
<span class="mi">5800</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ALL CONSTRAINTS ARE NON-LINEAR&#39;</span><span class="p">)</span>
<span class="mi">5900</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THERE ARE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; ACTIVE CONSTRAINTS&#39;</span><span class="p">)</span>
<span class="mi">6000</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINT NUMBERS ARE&#39;</span><span class="p">)</span>
<span class="mi">6100</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THERE ARE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; VIOLATED CONSTRAINTS&#39;</span><span class="p">)</span>
<span class="mi">6200</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THERE ARE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; ACTIVE SIDE CONSTRAINTS&#39;</span><span class="p">)</span>
<span class="mi">6300</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DECISION VARIABLES AT LOWER OR UPPER BOUNDS&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="s1">&#39; (MINUS INDICATES LOWER BOUND)&#39;</span><span class="p">)</span>
<span class="mi">6400</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ONE-DIMENSIONAL SEARCH&#39;</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INITIAL SLOPE =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;  PROPOSED ALPHA =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">6500</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;* * CONMIN DETECTS VLB(I)&gt;VUB(I)&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FIX IS SET X(I)=VLB(I)=VUB(I) = .5*(VLB(I)+VUB(I) FOR I =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">6600</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;* * CONMIN DETECTS INITIAL X(I)&lt;VLB(I)&#39;</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;X(I) =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  VLB(I) =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;X(I) IS SET EQUAL TO VLB(I) FOR I =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">6700</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;* * CONMIN DETECTS INITIAL X(I)&gt;VUB(I)&#39;</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;X(I) =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  VUB(I) =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e12</span><span class="p">.</span><span class="mi">4</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;X(I) IS SET EQUAL TO VUB(I) FOR I =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">6800</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TERMINATION CRITERION&#39;</span><span class="p">)</span>
<span class="mi">6900</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ITER EQUALS ITMAX&#39;</span><span class="p">)</span>
<span class="mi">7000</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="s1">&#39;NFEASCT CONSECUTIVE ITERATIONS FAILED TO PRODUCE A FEASIBLE DESIGN&#39;</span><span class="p">)</span>
<span class="mi">7100</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ABS(1-OBJ(I-1)/OBJ(I)) LESS THAN DELFUN FOR&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i3</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="s1">&#39; ITERATIONS&#39;</span><span class="p">)</span>
<span class="mi">7200</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t11</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ABS(OBJ(I)-OBJ(I-1))   LESS THAN DABFUN FOR&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i3</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">               </span><span class="s1">&#39; ITERATIONS&#39;</span><span class="p">)</span>
<span class="mi">7300</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NUMBER OF ITERATIONS =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">7400</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINT PARAMETER, BETA =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>

<span class="mi">7500</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;* * * * * * * * * * * * * * * * * * * * * * * * * * * &#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,&amp;</span>
<span class="w">                </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t34</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;C O N M I N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t29</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39; FORTRAN PROGRAM FOR &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t23</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;CONSTRAINED FUNCTION MINIMIZATION&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t65</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t13</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;* * * * * * * * * * * * * * * * * * * * * * * * * * * &#39;</span><span class="p">)</span>
<span class="mi">7600</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINED FUNCTION MINIMIZATION&#39;</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONTROL PARAMETERS&#39;</span><span class="p">)</span>
<span class="mi">7700</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IPRINT  NDV    ITMAX    NCON    NSIDE  ICNDIR   NSCAL NFDG&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="mi">8</span><span class="n">i8</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LINOBJ  ITRM     N1      N2      N3      N4      N5&#39;</span><span class="o">/</span><span class="mi">8</span><span class="n">i8</span><span class="p">)</span>
<span class="mi">7800</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FDCH&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t26</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FDCHM&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t42</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ALPHAX&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t58</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ABOBJ1&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">))</span>
<span class="mi">7900</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CT&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t26</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CTMIN&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t42</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CTL&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t58</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CTLMIN&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THETA&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t26</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PHI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t42</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DELFUN&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">t58</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DABFUN&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">))</span>
<span class="mi">8000</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LOWER BOUNDS ON DECISION VARIABLES (VLB)&#39;</span><span class="p">)</span>
<span class="mi">8100</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UPPER BOUNDS ON DECISION VARIABLES (VUB)&#39;</span><span class="p">)</span>
<span class="mi">8200</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;UNCONSTRAINED FUNCTION MINIMIZATION&#39;</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;CONTROL PARAMETERS&#39;</span><span class="p">)</span>
<span class="mi">8300</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SCALING VECTOR (SCAL)&#39;</span><span class="p">)</span>
<span class="mi">8400</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BEGIN ITERATION NUMBER&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">)</span>
<span class="mi">8500</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CT =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     CTL =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     PHI =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">8600</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NEW SCALING VECTOR (SCAL)&#39;</span><span class="p">)</span>
<span class="mi">8700</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GRADIENT OF OBJ&#39;</span><span class="p">)</span>
<span class="mi">8800</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GRADIENTS OF ACTIVE AND VIOLATED CONSTRAINTS&#39;</span><span class="p">)</span>
<span class="mi">8900</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="mi">9000</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PUSH-OFF FACTORS, (THETA(I), I=1,NAC)&#39;</span><span class="p">)</span>
<span class="mi">9100</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SEARCH DIRECTION (S-VECTOR)&#39;</span><span class="p">)</span>
<span class="mi">9200</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CALCULATED ALPHA =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">9300</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ITER =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     OBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     NO CHANGE IN OBJ&#39;</span><span class="p">)</span>
<span class="mi">9400</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e15</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     NO CHANGE ON OBJ&#39;</span><span class="p">)</span>
<span class="mi">9500</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e15</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span>
<span class="mi">9600</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ITER =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;     OBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e14</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">9700</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;INITIAL FUNCTION INFORMATION&#39;</span><span class="o">//</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OBJ =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">e15</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span>
<span class="mi">9800</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DECISION VARIABLES (X-VECTOR)&#39;</span><span class="p">)</span>
<span class="mi">9900</span><span class="w">    </span><span class="k">format</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span><span class="w"> </span><span class="mf">7e13</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
<span class="mi">10000</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINT VALUES (G-VECTOR)&#39;</span><span class="p">)</span>
<span class="mi">10100</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="n">i5</span><span class="p">)</span>
<span class="mi">10200</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;THE NUMBER OF ACTIVE AND VIOLATED CONSTRAINTS EXCEEDS N3-1.&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DIMENSIONED SIZE OF MATRICES A AND B AND VECTOR IC IS INSUFFICIENT&#39;</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OPTIMIZATION TERMINATED AND CONTROL RETURNED TO MAIN PROGRAM.&#39;</span><span class="p">)</span>
<span class="mi">10300</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">///</span><span class="s1">&#39;    FINAL OPTIMIZATION INFORMATION&#39;</span><span class="p">)</span>
<span class="mi">10400</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OBJECTIVE FUNCTION WAS EVALUATED        &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  TIMES&#39;</span><span class="p">)</span>
<span class="mi">10500</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSTRAINT FUNCTIONS WERE EVALUATED&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  TIMES&#39;</span><span class="p">)</span>
<span class="mi">10600</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GRADIENT OF OBJECTIVE WAS CALCULATED&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i9</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  TIMES&#39;</span><span class="p">)</span>
<span class="mi">10700</span><span class="w">   </span><span class="k">format</span><span class="p">(</span><span class="o">/</span><span class="n">t6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GRADIENTS OF CONSTRAINTS WERE CALCULATED&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;  TIMES&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">conmin</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              conmin
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>